{"version":3,"sources":["webpack:///./src/pages/search/store/reducer.js","webpack:///./src/pages/search/store/actionCreator.js","webpack:///./src/pages/search/components/notfound/index.js","webpack:///./src/pages/search/store/constants.js","webpack:///./src/pages/home/components/list/components/dumblist/index.js","webpack:///./src/pages/search/store/index.js","webpack:///./src/pages/search/index.js"],"names":["_immutable","__webpack_require__","constants","defaultState","fromJS","articlelist","nextPage","showSearchResult","hasMore","keyword","searchType","reducer","state","arguments","length","undefined","action","type","ADD_PAGE","set","page","UPDATE_ARTICLES_IN_SEARCH","get","concat","articles","CHANGE_KEYWORD","merge","CHANGE_SEARCH_RESULT_SHOW","CHANGE_HAS_MORE","_config","searchAsyncAC","requestPage","dispatch","axios","requestURL","location","search","then","_ref","_ref$data","data","code","users","usersWithoutRepeat","articlesWithNickname","map","article","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","_getIterator3","default","next","done","_ref3","value","id","nickname","authorId","_extends3","err","return","updateArticlesAC","changeShowSearchResultAC","changeHasMore","catch","console","log","currentPage","step","addPageAC","changeKeywordAndTypeAC","NotFound","props","_react2","createElement","className","_reactRouterDom","DumbList","item","index","key","Link","to","target","onClick","loadmore","_reducer","actionCreators","_notfound","_reactRedux","_dumblist","_store","Search","this","changeKeyword","Fragment","_header2","React","Component","connect","getIn","decodeURI","match","slice","indexOf"],"mappings":"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","file":"search_923c05c8.js","sourcesContent":["import { fromJS } from \"immutable\";\r\nimport * as constants from \"./constants\";\r\n\r\nconst defaultState = fromJS({\r\n  articlelist: [],\r\n  nextPage: 0,\r\n  showSearchResult: true,\r\n  hasMore: true,\r\n  keyword: '',\r\n  searchType: 'keyword',\r\n});\r\n\r\nconst reducer = (state = defaultState, action) => {\r\n  switch (action.type) {\r\n    case constants.ADD_PAGE:\r\n      return state.set('nextPage', action.page);\r\n    case constants.UPDATE_ARTICLES_IN_SEARCH:\r\n      return state.set('articlelist', state.get('articlelist').concat(fromJS(action.articles)));\r\n    case constants.CHANGE_KEYWORD:\r\n      // return state.set('keyword', action.keyword);\r\n      return state.merge({\r\n        searchType: action.searchType,\r\n        keyword: action.keyword,\r\n      });\r\n    case constants.CHANGE_SEARCH_RESULT_SHOW:\r\n      return state.set('showSearchResult', action.showSearchResult);\r\n    case constants.CHANGE_HAS_MORE:\r\n      return state.set('hasMore', action.hasMore);\r\n    default:\r\n      return state;\r\n  }\r\n};\r\n\r\nexport { reducer };","import axios from \"axios\";\r\nimport * as constants from \"./constants\";\r\nimport { requestURL } from \"../../../common/config\";\r\nconst addPageAC = (currentPage, step) => ({\r\n  type: constants.ADD_PAGE,\r\n  page: currentPage + step,\r\n});\r\nconst updateArticlesAC = (articles) => ({\r\n  type: constants.UPDATE_ARTICLES_IN_SEARCH,\r\n  articles,\r\n});\r\nconst changeKeywordAndTypeAC = (searchType, keyword) => ({\r\n  type: constants.CHANGE_KEYWORD,\r\n  searchType,\r\n  keyword,\r\n});\r\nconst changeShowSearchResultAC = (showSearchResult) => ({\r\n  type: constants.CHANGE_SEARCH_RESULT_SHOW,\r\n  showSearchResult,\r\n});\r\nconst changeHasMore = (hasMore) => ({\r\n  type: constants.CHANGE_HAS_MORE,\r\n  hasMore,\r\n});\r\nconst searchAsyncAC = (requestPage) => {\r\n  return function (dispatch) {\r\n    axios.get(`${requestURL}search/search${location.search}&page=${requestPage}`)\r\n      .then(({ data: { code, articles, usersWithoutRepeat: users } }) => {\r\n        switch (code) {\r\n          case 1:\r\n            {\r\n              const articlesWithNickname = articles.map((article) => {\r\n                for (const { id, nickname } of users) {\r\n                  if (article.nickname === undefined && article.authorId === id) {\r\n                    return { ...article, nickname };\r\n                  }\r\n                }\r\n              });\r\n              dispatch(updateArticlesAC(articlesWithNickname));\r\n            }\r\n            break;\r\n          case 0:\r\n            if (requestPage === 0) {//第一次请求就没有查找到。\r\n              dispatch(changeShowSearchResultAC(false));\r\n            }\r\n            dispatch(changeHasMore(false));\r\n            break;\r\n\r\n          default:\r\n            break;\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      });\r\n    dispatch(addPageAC(requestPage, 1));\r\n  };\r\n};\r\n\r\nexport { searchAsyncAC, changeKeywordAndTypeAC };","import React from \"react\";\r\nimport \"./index.scss\";\r\n\r\nconst NotFound = (props) => (\r\n  <div className='not_container'>\r\n    {\r\n      props.searchType === 'keyword' ?\r\n        <h1 className='not_description'>抱歉，未找到与<span className='not_keyword'>{props.keyword}</span>相关的内容~</h1>\r\n        :\r\n        <h1 className='not_description'>抱歉，<span className='not_keyword'>{props.keyword}</span>分类下暂无内容~</h1>\r\n    }\r\n  </div>\r\n);\r\n\r\nexport { NotFound };","const ADD_PAGE = 'add_page';\r\nconst UPDATE_ARTICLES_IN_SEARCH = 'update_articles_in_search';\r\nconst CHANGE_KEYWORD = 'change_keyword';\r\nconst CHANGE_SEARCH_RESULT_SHOW = 'change_search_result_show';\r\nconst CHANGE_HAS_MORE = 'change_has_more';\r\n\r\nexport { ADD_PAGE, UPDATE_ARTICLES_IN_SEARCH, CHANGE_KEYWORD, CHANGE_SEARCH_RESULT_SHOW, CHANGE_HAS_MORE };","import React from \"react\";\r\nimport { Link } from \"react-router-dom\";\r\nimport \"./index.scss\";\r\n\r\n/**\r\n * \r\n * @param {object} props props对象，需要包含articlelist，loadmore，requestPage。\r\n */\r\nconst DumbList = (props) => (\r\n  <section className='articlelist_container'>\r\n    <ul className='articlelist_list'>\r\n      {\r\n        props.articlelist.map((item, index) => {\r\n          return (\r\n            // <li className='articlelist_Item' key={item.get('id')}>\r\n            <li className='articlelist_Item' key={index}>\r\n              <div className='articlelist_summary'>\r\n                {/* <a className='summary_title' target='_blank'>{item.get('title')}</a> */}\r\n                <Link to={`/detail/${item.get('articleId')}`} className='summary_title' target='_blank'>{item.get('articleName')}</Link>\r\n                <p className='summary_content'>{item.get('description')}</p>\r\n                <div className='summary_extraInfo'>\r\n                  <a className='extraInfo_author' target='_blank'>{item.get('nickname')}</a>\r\n                  <span className='extraInfo_comments' target='_blank'><span className='iconfont icon-duihuakuang1'>创作于{item.get('createTime')}</span></span>\r\n                  {\r\n                    item.get('updateTime') ? <span className='extraInfo_likes'><span className='iconfont icon-xin'>更新于{item.get('updateTime')}</span></span> : null\r\n                  }\r\n                  {/* {item.get('donatesCount') ? <span className='extraInfo_donates'><span className='iconfont icon-renminbi'>{item.get('donatesCount')}</span></span> : null} */}\r\n                </div>\r\n              </div>\r\n              {/* {\r\n                item.get('imgUrl') ?\r\n                  (<a className='articlelist_link' target='_blank'>\r\n                    <img alt='' className='articlelist_img' src='https://upload-images.jianshu.io/upload_images/1096130-83e32b3e990f4c91.jpg?imageMogr2/auto-orient/strip|imageView2/1/w/300/h/240' />\r\n                  </a>) :\r\n                  null\r\n              } */}\r\n            </li>\r\n          );\r\n        })\r\n      }\r\n    </ul>\r\n    {\r\n      props.hasMore ?\r\n        <a className='articlelist_loadmore' onClick={() => { props.loadmore(props.requestPage); }}>阅读更多</a>\r\n        :\r\n        <a className='articlelist_loadmore'>没有更多啦！</a>\r\n    }\r\n  </section>\r\n);\r\n\r\nexport { DumbList };","import { reducer } from \"./reducer\";\r\nimport * as actionCreators from \"./actionCreator\";\r\nimport * as constants from \"./constants\";\r\n\r\nexport { reducer, actionCreators, constants };","import React from \"react\";\r\nimport Header from \"../../common/header\";\r\nimport { NotFound } from \"./components/notfound\";\r\nimport { connect } from \"react-redux\";\r\nimport { DumbList } from \"../home/components/list/components/dumblist\";\r\nimport { actionCreators } from \"./store\";\r\nimport \"./index.scss\";\r\n\r\nclass Search extends React.Component {\r\n  componentDidMount() {\r\n    this.props.loadmore(this.props.requestPage);\r\n    this.props.changeKeyword();\r\n  }\r\n  render() {\r\n    return (\r\n      <React.Fragment>\r\n        <Header />\r\n        <section className='search_container'>\r\n          {\r\n            this.props.showSearchResult ?\r\n              <React.Fragment>\r\n                {\r\n                  this.props.searchType === 'keyword' ?\r\n                    <h1 className='search_h1'>为您列出关键字是<span>{this.props.keyword}</span>的搜索结果：</h1>\r\n                    :\r\n                    <h1 className='search_h1'>为您列出<span>{this.props.keyword}</span>分类下的文章：</h1>\r\n                }\r\n                <DumbList {...this.props} />\r\n              </React.Fragment>\r\n              :\r\n              <NotFound keyword={this.props.keyword} searchType={this.props.searchType} />\r\n          }\r\n        </section>\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\nconst mapState = (state) => ({\r\n  articlelist: state.getIn(['search', 'articlelist']),\r\n  requestPage: state.getIn(['search', 'nextPage']),\r\n  showSearchResult: state.getIn(['search', 'showSearchResult']),\r\n  keyword: state.getIn(['search', 'keyword']),\r\n  searchType: state.getIn(['search', 'searchType']),\r\n  hasMore: state.getIn(['search', 'hasMore']),\r\n});\r\nconst mapDispatch = (dispatch) => ({\r\n  loadmore(requestPage) {\r\n    dispatch(actionCreators.searchAsyncAC(requestPage));\r\n  },\r\n  changeKeyword() {\r\n    let search = decodeURI(location.search);\r\n    let type = search.match(/^\\?(keyword|category)/i)[1];\r\n    dispatch(actionCreators.changeKeywordAndTypeAC(type, search.slice(search.indexOf('=') + 1)));\r\n  },\r\n});\r\nexport default connect(mapState, mapDispatch)(Search);"],"sourceRoot":""}