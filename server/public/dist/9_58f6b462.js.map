{"version":3,"sources":["webpack:///./src/pages/write/index.js","webpack:///./src/pages/write/components/inputwithbuttons/index.js","webpack:///./src/pages/write/components/inputwithbuttons/index.scss?9b46","webpack:///./src/pages/write/components/inputwithbuttons/index.scss","webpack:///./src/pages/write/containers/mutistatesbutton/index.js","webpack:///./src/common/mutistatesbutton/index.js","webpack:///./src/common/mutistatesbutton/index.scss?68ff","webpack:///./src/common/mutistatesbutton/index.scss","webpack:///./src/pages/write/containers/publishpop/index.js","webpack:///./src/pages/write/containers/publishpop/index.scss?c1b5","webpack:///./src/pages/write/containers/publishpop/index.scss","webpack:///./src/pages/write/index.scss?7090","webpack:///./src/pages/write/index.scss"],"names":["__webpack_require__","_reactRedux","_reactRouterDom","_store","_inputwithbuttons","_authentication","_config","Write","state","currentFocus","getNewArticleId","arguments","length","undefined","_this","props","currentArticleId","handleTitleFocus","setState","_this2","this","requestData","hide","_message3","default","loading","authentication","then","_ref3","data","success","error","history","push","catch","err","console","log","_props","editor","requestArticleId","articles","article","toJS","find","_ref4","articleId","autoSave","txt","html","articleContent","_this3","_props2","handleContentChange","handleTitleChange","initEditor","E","customConfig","uploadImgServer","requestURL","onfocus","timerArray","onchange","id","timer","setTimeout","pop","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","_getIterator3","next","done","value","clearTimeout","return","newId","create","titleTimerArray","titleInput","addEventListener","_ref5","target","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_step2","_iterator2","_this4","_props3","notebooks","showInput","handleBtnClick","getInputValue","createInputValue","handleConfirm","handleCancel","articleBtnDisabled","handleSelect","currentSelectedNotebookId","initOpen","handleDelete","createType","Content","_layout2","Header","Sider","Footer","DirectoryTree","_tree2","TreeNode","notebooksData","articlesData","_react2","createElement","className","theme","width","_button2","block","type","href","defaultExpandAll","expandAction","onSelect","_len2","rest","Array","_key2","map","notebook","title","notebookName","key","notebookId","isLeaf","filter","_ref6","articleName","onClick","disabled","InputWithButtons","style","marginLeft","_spin2","spinning","placeholder","onFocus","ref","input","_mutistatesbutton2","_publishpop2","React","Component","connect","getIn","dispatch","actionCreators","changeStatus","requestDataFunctionAC","updateCertainArticleAC","autoSaveFunctionAC","updateType","Date","toLocaleString","_len3","_key3","v","trim","saveNotebookFunctionAC","saveArticleFunctionAC","finished","e","replace","_ref7","titleInputEl","_ref8","_slicedToArray3","selectedKeys","_e$node$props","node","eventKey","Number","getNotesDetailAsyncAC","deleteArticleAndNotebookAsyncAC","withRouter","div","classList","contains","add","_input2","document","activeElement","focus","onChange","_buttonGroup2","content","module","i","options","hmr","transform","insertInto","locals","exports","_mutistatesbutton","_actionCreators","SmartMutiStatesButton","autoSaving","btnClick","dumbProps","btnText","btnSpinning","btnType","publishSite","pubDisabled","Fragment","MutiStatesButton","_props$dumbProps","size","FormItem","_form2","Item","classOptions","label","children","CollectionCreateForm","mapPropsToFields","createFormField","_React$Component","_class","_classCallCheck3","_possibleConstructorReturn3","__proto__","_getPrototypeOf2","apply","_inherits3","_createClass3","visible","onCancel","onCreate","form","modelOkText","getFieldDecorator","_modal2","okText","cancelText","onOk","layout","rules","required","message","maxLength","_cascader2","TextArea","PublishPop","handleCreate","formRef","_this2$props","handlePublish","saveFormRef","pubPanelShow","handleFieldsChange","wrappedComponentRef","slice","changedFields","validateFields","values","obj","publishAsyncAC","resetFields"],"mappings":"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","file":"9_58f6b462.js","sourcesContent":["import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport E from \"wangeditor\";\r\nimport { Layout, Menu, Icon, Button, Tree, message, Spin } from \"antd\";\r\nimport { Link, withRouter } from \"react-router-dom\";\r\nimport { actionCreators } from \"./store\";\r\nimport { InputWithButtons } from \"./components/inputwithbuttons\";\r\nimport MutiStatesButton from \"./containers/mutistatesbutton\";\r\nimport PublishPop from \"./containers/publishpop\";\r\nimport './index.scss';\r\nimport { authentication } from \"../../common/authentication\";\r\nimport { requestURL } from \"../../common/config\";\r\nclass Write extends React.Component {\r\n  state = {\r\n    currentFocus: 'title',\r\n  }\r\n  componentWillMount() {\r\n    const { requestData } = this.props;\r\n    //权限认证\r\n    const hide = message.loading('检查登录状态ing');\r\n    authentication()\r\n      .then(({ data: code }) => {\r\n        if (code) {\r\n          requestData();\r\n          hide();\r\n          message.success('欢迎回来，英雄！', 2);\r\n        } else {\r\n          hide();\r\n          message.error('英雄请留步，请您先登录~', 2);\r\n          this.props.history.push('/login');\r\n        }\r\n      })\r\n      .catch(err => {\r\n        console.log(err);\r\n      })\r\n  }\r\n  componentDidUpdate() {\r\n    const { editor, currentArticleId, requestArticleId, articles } = this.props;\r\n    if (this.state.currentFocus === 'none' && currentArticleId === requestArticleId) {\r\n      const article = articles.toJS().find(({ articleId }) => currentArticleId === articleId);\r\n      if (article && !article.autoSave) {//第二个判断：用户点击了文章，组件更新后自动聚焦于内容，但是没有触发editor的focus事件，currentFocus依然是none；用户输入后触发自动保存，自动保存触发组件更新，currentFocus依然是none，在网速慢或者运行慢的情况下，有可能会出现本地保存的内容覆盖了输入的内容，因此要在自动更新时，为本地存储添加一个autosave的字段，阻止这次覆盖。\r\n        editor.txt.html(article.articleContent);\r\n      }\r\n    }\r\n  }\r\n  componentDidMount() {\r\n    const { handleContentChange, handleTitleChange, initEditor } = this.props;\r\n    const editor = new E('.editor_toolbar', '.editor_text');\r\n    editor.customConfig.uploadImgServer = `${requestURL}upload`;\r\n    editor.customConfig.onfocus = () => {\r\n      this.setState({\r\n        currentFocus: 'content',\r\n      });\r\n    }\r\n\r\n    // const autoSaveFn = (timerArray, value, change) => {\r\n    //   const id = this.getNewArticleId();\r\n    //   let timer = setTimeout(() => {\r\n    //     if (timerArray.length > 1) {\r\n    //       timerArray.pop();\r\n    //       for (const timer of timerArray) {\r\n    //         clearTimeout(timer);\r\n    //       }\r\n    //     } else {\r\n    //       const newId = this.getNewArticleId();\r\n    //       if (id === newId) {\r\n    //         change(value, id);\r\n    //       }\r\n    //     }\r\n    //     timerArray = [];\r\n    //   }, 1500);\r\n    //   timerArray.push(timer);\r\n    // }\r\n\r\n    //内容自动保存逻辑\r\n    let timerArray = [];\r\n    editor.customConfig.onchange = (html) => {\r\n      // autoSaveFn(timerArray, html, handleContentChange);//won't work\r\n      const id = this.getNewArticleId();\r\n      let timer = setTimeout(() => {\r\n        if (timerArray.length > 1) {\r\n          timerArray.pop();\r\n          for (const timer of timerArray) {\r\n            clearTimeout(timer);\r\n          }\r\n        } else {\r\n          const newId = this.getNewArticleId();\r\n          if (id === newId) {\r\n            handleContentChange(html, id);\r\n          }\r\n        }\r\n        timerArray = [];\r\n      }, 1500);\r\n      timerArray.push(timer);\r\n    };\r\n    //内容自动保存逻辑\r\n\r\n    editor.create();\r\n    initEditor(editor);\r\n\r\n    //标题自动保存逻辑\r\n    let titleTimerArray = [];\r\n    this.titleInput.addEventListener('input', ({ target: { value } }) => {\r\n      const id = this.getNewArticleId();\r\n      let timer = setTimeout(() => {\r\n        if (titleTimerArray.length > 1) {\r\n          titleTimerArray.pop();\r\n          for (const timer of titleTimerArray) {\r\n            clearTimeout(timer);\r\n          }\r\n        } else {\r\n          const newId = this.getNewArticleId();\r\n          if (id === newId) {\r\n            handleTitleChange(value, id);\r\n          }\r\n        }\r\n        titleTimerArray = [];\r\n      }, 1500);\r\n      titleTimerArray.push(timer);\r\n    });\r\n    //标题自动保存逻辑\r\n  }\r\n\r\n  getNewArticleId = ({ currentArticleId } = this.props) => currentArticleId\r\n  // handleTitleChange = (value, getId) => {\r\n  // let { timerArray } = this.state;\r\n  // const id = this.getNewArticleId();\r\n  // let timer = setTimeout(() => {\r\n  //   console.log(timerArray);\r\n  //   if (timerArray.length > 1) {\r\n  //     timerArray.pop();\r\n  //     for (const timer of timerArray) {\r\n  //       clearTimeout(timer);\r\n  //     }\r\n  //   } else {\r\n  //     const newId = this.getNewArticleId();\r\n  //     if (id === newId) {\r\n  //       // handleContentChange(html, id);\r\n  //       console.log('应当更新');\r\n  //     }\r\n  //   }\r\n  // }, 1500);\r\n  // timerArray.push(timer);\r\n  // }\r\n\r\n  handleTitleFocus = () => {\r\n    this.setState({\r\n      currentFocus: 'title',\r\n    });\r\n  }\r\n  render() {\r\n    const { editor, notebooks, articles, showInput,\r\n      handleBtnClick, getInputValue, createInputValue, handleConfirm, handleCancel,\r\n      articleBtnDisabled, handleSelect, currentSelectedNotebookId, currentArticleId, initOpen, handleDelete,\r\n      loading, createType,\r\n    } = this.props;\r\n    const { Header, Content, Footer, Sider } = Layout;\r\n    const { DirectoryTree, TreeNode } = Tree;\r\n\r\n    let notebooksData = [];\r\n    let articlesData = [];\r\n    if (notebooks && articles) {\r\n      notebooksData = notebooks.toJS();\r\n      articlesData = articles.toJS();\r\n    }\r\n    return (\r\n      <Layout className='main'>\r\n        {/* 左侧边栏 */}\r\n        <Sider theme='light' width='300' className='sider-fixed'>\r\n          <Button block type='primary' href='/' >回首页</Button>\r\n          <DirectoryTree defaultExpandAll expandAction='doubleClick'\r\n            onSelect={(...rest) => {\r\n              this.setState({\r\n                currentFocus: 'none',\r\n              });\r\n              handleSelect(rest, editor, articlesData, this.titleInput);\r\n            }}\r\n          >\r\n            {\r\n              notebooksData.map(notebook => {\r\n                return (\r\n                  <TreeNode title={notebook.notebookName} key={notebook.notebookId} isLeaf={false}>\r\n                    {\r\n                      articlesData.filter((article) => article.notebookId === notebook.notebookId)\r\n                        .map(({ articleId, articleName }) => <TreeNode title={articleName} key={articleId} isLeaf={true} />)\r\n                    }\r\n                  </TreeNode>\r\n                );\r\n              }\r\n              )\r\n            }\r\n          </DirectoryTree>\r\n          <Button block onClick={() => { handleBtnClick('note') }}>新建文集</Button>\r\n          <Button block onClick={() => { handleBtnClick('article'); }} disabled={articleBtnDisabled}>{articleBtnDisabled ? '选中文集--新建文章' : '新建文章'}</Button>\r\n          <Button block onClick={() => { handleDelete(currentArticleId, articlesData, notebooksData) }} type='danger' disabled={!articleBtnDisabled || initOpen}>{!articleBtnDisabled ? '选中文章--删除文章' : '删除文章'}</Button>\r\n          {showInput ?\r\n            <InputWithButtons {...{ getInputValue, createInputValue, handleConfirm, handleCancel, createType, currentSelectedNotebookId }} />\r\n            :\r\n            null\r\n          }\r\n        </Sider>\r\n        {/* 右内容区 */}\r\n        {/* <Layout className='content_container'> */}\r\n        <Layout style={{ marginLeft: 300 }}>\r\n          <Content className='editor_container'>\r\n            <div className={initOpen ? 'show_mask' : 'hide_mask'}><p>选择文章以开始编辑</p></div>\r\n            <Spin spinning={loading}>\r\n              <input type='text' className='editor_title' placeholder='请输入标题'\r\n                onFocus={this.handleTitleFocus}\r\n                ref={input => { this.titleInput = input; }} />\r\n              {/* 将生成编辑器 */}\r\n              <div className='editor_border'>\r\n                <div className='editor_toolbar'></div>\r\n              </div>\r\n              <div className='editor_text'></div>\r\n              <MutiStatesButton {...{ articlesData }} />\r\n              <PublishPop {...{ articlesData }} />\r\n            </Spin>\r\n          </Content>\r\n        </Layout>\r\n      </Layout>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapState = (state) => {\r\n  return {\r\n    editor: state.getIn(['write', 'editor']),\r\n    notebooks: state.getIn(['write', 'data', 'notebooks']),\r\n    articles: state.getIn(['write', 'data', 'articles']),\r\n    showInput: state.getIn(['write', 'showInput']),\r\n    createInputValue: state.getIn(['write', 'createInputValue']),\r\n    articleBtnDisabled: state.getIn(['write', 'articleBtnDisabled']),\r\n    currentSelectedNotebookId: state.getIn(['write', 'currentSelectedNotebookId']),\r\n    currentArticleId: state.getIn(['write', 'currentArticleId']),\r\n    requestArticleId: state.getIn(['write', 'requestArticleId']),\r\n    loading: state.getIn(['write', 'loading']),\r\n    createType: state.getIn(['write', 'createType']),\r\n    initOpen: state.getIn(['write', 'initOpen']),\r\n  };\r\n};\r\n\r\nconst mapDispatch = (dispatch) => {\r\n  return {\r\n    // handleChange(html, timerArray, getId) {/********************here!!!!!!**************************************/\r\n    //   const id = getId();\r\n\r\n    //   let timer = setTimeout(() => {\r\n    //     if (timerArray.length > 1) {\r\n    //       timerArray.pop();\r\n    //       for (const timer of timerArray) {\r\n    //         clearTimeout(timer);\r\n    //       }\r\n    //     } else {\r\n    //       const newId = getId();\r\n    //       if (id === newId) {\r\n    //         console.log('触发自动保存。');\r\n    //         // handleContentChange(html, id);//内容存储到服务器上\r\n    //         dispatch(actionCreators.autoSaveFunctionAC({ articleContent: html, articleId: id }));\r\n    //         dispatch(actionCreators.updateCertainArticleAC({ articleContent: html, articleId: id, autoSave: true }));\r\n    //       }\r\n    //     }\r\n    //     timerArray = [];\r\n    //   }, 1500);\r\n\r\n\r\n    //   timerArray.push(timer);\r\n    //   console.log(timerArray);\r\n    // },\r\n    initEditor(editor) {\r\n      dispatch(actionCreators.changeStatus('editor', editor));\r\n    },\r\n    requestData() {\r\n      dispatch(actionCreators.requestDataFunctionAC());\r\n    },\r\n    handleTitleChange(value, id) {\r\n      dispatch(actionCreators.updateCertainArticleAC({ articleName: value, articleId: id }));\r\n      dispatch(actionCreators.autoSaveFunctionAC({ articleName: value, articleId: id, updateType: 'articleName' }));\r\n    },\r\n    handleContentChange(value, id, autoSave = true) {\r\n      dispatch(actionCreators.updateCertainArticleAC({ articleContent: value, articleId: id, autoSave }));\r\n      dispatch(actionCreators.autoSaveFunctionAC({ articleContent: value, articleId: id, updateType: 'articleContent' }));\r\n    },\r\n    handleBtnClick(type) {\r\n      dispatch(actionCreators.changeStatus('createType', type));\r\n      dispatch(actionCreators.changeStatus('showInput', true));\r\n      dispatch(actionCreators.changeStatus('createInputValue', new Date().toLocaleString()));\r\n    },\r\n    handleConfirm(...rest) {\r\n      const [v, type, currentSelectedNotebookId] = rest;\r\n      if (v.trim()) {\r\n        const hide = message.loading('创建中……');\r\n        switch (type) {\r\n          case 'note':\r\n            dispatch(actionCreators.saveNotebookFunctionAC(hide, v));\r\n            break;\r\n          case 'article':\r\n            dispatch(actionCreators.saveArticleFunctionAC(//请求服务器存储新**手动**创建的文章。\r\n              hide,\r\n              {\r\n                notebookId: currentSelectedNotebookId,\r\n                articleName: v,\r\n                articleContent: '',\r\n                finished: false,\r\n              },\r\n              false\r\n            ));\r\n            break;\r\n          default:\r\n            break;\r\n        }\r\n        dispatch(actionCreators.changeStatus('showInput', false));\r\n      }\r\n    },\r\n    handleCancel() {\r\n      dispatch(actionCreators.changeStatus('showInput', false));\r\n    },\r\n    getInputValue(e) {\r\n      dispatch(actionCreators.changeStatus('createInputValue', e.target.value.replace(/\\s+/g, ' ')));\r\n    },\r\n    handleSelect([selectedKeys, e], editor, articlesData, titleInputEl) {//******************handleSelect********************************/\r\n      const { node: { props: { isLeaf, eventKey } } } = e;\r\n      if (!isLeaf) {//如果点击的是文集\r\n        dispatch(actionCreators.changeStatus('currentSelectedNotebookId', Number(eventKey)));\r\n      } else {//点击的是文章，异步获取文章详情，然后呈现出来。\r\n        const currentArticleId = Number(selectedKeys[0]);\r\n        dispatch(actionCreators.changeStatus('currentArticleId', currentArticleId));//currentArticleId也要同步。\r\n        dispatch(actionCreators.changeStatus('initOpen', false));\r\n        const article = articlesData.find((article) => article.articleId === currentArticleId);\r\n        titleInputEl.value = article.articleName;\r\n        if (article.articleContent !== undefined) {\r\n          editor.txt.html(article.articleContent);\r\n        } else {\r\n          dispatch(actionCreators.getNotesDetailAsyncAC(currentArticleId, editor));\r\n        }\r\n      }\r\n      dispatch(actionCreators.changeStatus('articleBtnDisabled', isLeaf));\r\n    },\r\n    handleDelete(articleId, articles, notebooks) {\r\n      const article = articles.find((article) => article.articleId === articleId);\r\n      const notebookId = article.notebookId;\r\n      const articlesInThisNotebook = articles.filter((article) => article.notebookId === notebookId);\r\n      if (articlesInThisNotebook.length === 1) {\r\n        //删除文章及其文集\r\n        dispatch(actionCreators.deleteArticleAndNotebookAsyncAC(articleId, notebookId));\r\n      } else {\r\n        //只删除文章\r\n        dispatch(actionCreators.deleteArticleAndNotebookAsyncAC(articleId));\r\n      }\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(mapState, mapDispatch)(withRouter(Write));","import React from \"react\";\r\nimport { Input, Button } from \"antd\";\r\nimport ButtonGroup from \"antd/lib/button/button-group\";\r\nimport { CSSTransition } from \"react-transition-group\";\r\n\r\nimport \"./index.scss\";\r\n\r\n// class InputWithButtons extends React.Component {//类式组件，使用css-transition，动画触发的时机需要注意，应该是组件更新时触发。\r\n//   state = {\r\n//     beginAnimate: false,\r\n//   }\r\n//   componentDidMount() {\r\n//     this.input.focus();\r\n//     this.setState({\r\n//       beginAnimate: true,\r\n//     });\r\n//   }\r\n//   render() {\r\n//     console.log(this.props);\r\n//     const { handleInputBlur, getInputValue, createInputValue } = this.props;\r\n//     return (\r\n//       <CSSTransition in={this.state.beginAnimate} timeout={300} classNames='show' >\r\n//         <div className='input_container'>\r\n//           <Input placeholder='请输入标题' ref={input => { this.input = input }}\r\n//             value={createInputValue}\r\n//             onChange={getInputValue} />\r\n//           <ButtonGroup className='input_btns'>\r\n//             <Button type='default'>确认</Button>\r\n//             <Button type='danger'>取消</Button>\r\n//           </ButtonGroup>\r\n//         </div >\r\n//       </CSSTransition>\r\n\r\n//     );\r\n//   }\r\n// }\r\n\r\nfunction InputWithButtons(props) {//函数式组件，不使用css-transition，ref的获取需要注意。函数式组件上不可以使用ref，因为没有实例。\r\n  const { getInputValue, createInputValue, handleConfirm, handleCancel, createType, currentSelectedNotebookId } = props;\r\n  return (\r\n    <div className='input_container' ref={div => {//函数式获取ref。DOM元素上使用ref获取的是DOM节点。\r\n      if (div && !div.classList.contains('show')) {\r\n        setTimeout(() => {\r\n          div.classList.add('show');\r\n        }, 0);\r\n      }\r\n    }}>\r\n      <Input placeholder='请输入标题' ref={input => {//类式组件上使用ref获取的是类的实例\r\n        if (input && document.activeElement !== input.input) {\r\n          input.focus();\r\n        }\r\n      }}\r\n        value={createInputValue}\r\n        onChange={getInputValue} />\r\n      <ButtonGroup className='input_btns'>\r\n        <Button type='default' onClick={() => { handleConfirm(createInputValue, createType, currentSelectedNotebookId); }}>确认</Button>\r\n        <Button type='danger' onClick={handleCancel}>取消</Button>\r\n      </ButtonGroup>\r\n    </div >\r\n  );\r\n}\r\n\r\nexport { InputWithButtons };","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".input_container {\\n  margin-top: 20px;\\n  display: flex;\\n  flex-flow: column nowrap;\\n  align-items: center;\\n  opacity: 0;\\n  transform: scale(0.5) translateY(50%);\\n  transition: all .3s ease; }\\n  .input_container.show-enter {\\n    opacity: 0.01; }\\n  .input_container.show-enter-active {\\n    opacity: 1;\\n    transform: scale(1) translateY(0%);\\n    transition: all .3s ease; }\\n  .input_container.show-enter-done {\\n    opacity: 1;\\n    transform: scale(1) translateY(0%); }\\n\\n.show {\\n  opacity: 1;\\n  transform: scale(1) translateY(0%); }\\n\", \"\"]);\n\n// exports\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\nimport { actionCreators } from \"../../store\";\r\nimport { MutiStatesButton } from \"../../../../common/mutistatesbutton\";\r\nimport { changeStatus } from \"../../store/actionCreators\";\r\n\r\n\r\n\r\nclass SmartMutiStatesButton extends React.Component {\r\n  render() {\r\n    const { articlesData, currentArticleId, autoSaving, btnClick } = this.props;\r\n    const article = articlesData.find((article) => article.articleId === currentArticleId);\r\n    const handleBtnClick = () => {\r\n      btnClick(currentArticleId, article.finished);\r\n    };\r\n    let dumbProps = null;\r\n    if (article) {\r\n      dumbProps = {\r\n        btnText: article.finished ? '取消发布' : '发布',\r\n        btnSpinning: false,\r\n        btnType: 'primary',\r\n        href: article.publishSite,\r\n        disabled: !article.finished,\r\n        handleBtnClick,\r\n      };\r\n      if (autoSaving) {\r\n        dumbProps.btnText = '保存中…';\r\n        dumbProps.btnSpinning = true;\r\n        dumbProps.btnType = 'ghost';\r\n        dumbProps.pubDisabled = true;\r\n      }\r\n    }\r\n    return (\r\n      <React.Fragment>\r\n        {\r\n          currentArticleId ?\r\n            <MutiStatesButton dumbProps={dumbProps} />\r\n            : null\r\n        }\r\n      </React.Fragment>\r\n    );\r\n  }\r\n}\r\n\r\nconst mapState = (state) => {\r\n  return {\r\n    currentArticleId: state.getIn(['write', 'currentArticleId']),\r\n    autoSaving: state.getIn(['write', 'autoSaving']),\r\n  };\r\n};\r\n\r\nconst mapDispatch = (dispatch) => {\r\n  return {\r\n    btnClick(articleId, finished) {\r\n      if (finished) {\r\n        dispatch(actionCreators.autoSaveFunctionAC({ articleId, finished: false, updateType: 'finished' }));\r\n      } else {\r\n        dispatch(changeStatus('pubPanelShow', true));\r\n      }\r\n    },\r\n  };\r\n};\r\n\r\nexport default connect(mapState, mapDispatch)(SmartMutiStatesButton); ","import React from \"react\";\r\nimport { Button, Spin } from \"antd\";\r\n\r\nimport \"./index.scss\";\r\n\r\n\r\nclass MutiStatesButton extends React.Component {\r\n  render() {\r\n    const { btnType, btnText, btnSpinning, handleBtnClick, href, disabled, pubDisabled } = this.props.dumbProps;\r\n    return (\r\n      <div className='publish_btn_container'>\r\n        <Spin size='small' className='publish_btn-loading' spinning={btnSpinning}></Spin>\r\n        <Button href={href} type='primary' target='_blank' disabled={disabled} className='publish_btn_check'>查看发布</Button>\r\n        <Button type={btnType} block onClick={handleBtnClick} disabled={pubDisabled} className='publish_btn'>{btnText}</Button>\r\n      </div>\r\n    );\r\n  }\r\n}\r\nexport { MutiStatesButton };","\nvar content = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/sass-loader/lib/loader.js!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \".publish_btn_container {\\n  position: absolute;\\n  right: 16px;\\n  top: 60px;\\n  width: 210px; }\\n  .publish_btn_container .publish_btn, .publish_btn_container .publish_btn_check {\\n    width: 100px; }\\n  .publish_btn_container .publish_btn {\\n    float: right; }\\n  .publish_btn_container .publish_btn_check {\\n    float: left; }\\n  .publish_btn_container .publish_btn-loading {\\n    position: absolute;\\n    top: 50%;\\n    right: 80px;\\n    transform: translateY(-40%);\\n    z-index: 1; }\\n\", \"\"]);\n\n// exports\n","import React from \"react\";\r\nimport { connect } from \"react-redux\";\r\n\r\nimport { Button, Modal, Form, Input, Cascader } from 'antd';\r\nimport { actionCreators } from \"../../store\";\r\nimport \"./index.scss\";\r\n\r\nconst FormItem = Form.Item;\r\nconst classOptions = [\r\n  {\r\n    value: '编程',\r\n    label: '编程',\r\n    children: [\r\n      {\r\n        value: 'JavaScript',\r\n        label: 'JavaScript',\r\n      },\r\n      {\r\n        value: 'CSS',\r\n        label: 'CSS',\r\n      },\r\n      {\r\n        value: 'HTML',\r\n        label: 'HTML',\r\n      },\r\n      {\r\n        value: 'React全家桶',\r\n        label: 'React全家桶',\r\n      },\r\n      {\r\n        value: '小程序',\r\n        label: '小程序',\r\n      },\r\n      {\r\n        value: 'Webpack',\r\n        label: 'Webpack',\r\n      },\r\n      {\r\n        value: 'nodejs',\r\n        label: 'nodejs',\r\n      },\r\n      {\r\n        value: 'linux',\r\n        label: 'linux',\r\n      },\r\n      {\r\n        value: '规范解读',\r\n        label: '规范解读',\r\n      },\r\n    ],\r\n  },\r\n  {\r\n    value: '其他',\r\n    label: '其他',\r\n  }];\r\nconst CollectionCreateForm = Form.create(\r\n  {//Form.create(options)\r\n    // onFieldsChange(props, changedFields) {\r\n    //   props.onChange(changedFields);\r\n    // },\r\n    mapPropsToFields(props) {\r\n      return {\r\n        articleName: Form.createFormField(\r\n          {\r\n            value: props.title,\r\n          }\r\n        ),\r\n      };\r\n    },\r\n  }\r\n)(\r\n  class extends React.Component {//经过Form.create包装过的组件。\r\n    render() {\r\n      const { visible, onCancel, onCreate, form, modelOkText } = this.props;\r\n      const { getFieldDecorator } = form;\r\n      return (\r\n        <Modal visible={visible} title=\"很快就可以发布了……\" okText={modelOkText} cancelText='取消' onCancel={onCancel} onOk={onCreate} >\r\n\r\n          <Form layout=\"vertical\">\r\n            <FormItem label=\"标题\">\r\n              {\r\n                getFieldDecorator('articleName', {\r\n                  rules: [{ required: true, message: '请输入40字以内的标题！' }],\r\n                })(<Input maxLength={40} />)\r\n              }\r\n            </FormItem>\r\n\r\n            <FormItem label='分类'>\r\n              {\r\n                getFieldDecorator('class', {\r\n                  rules: [{ required: true, message: '请选择分类~' }],\r\n                })(<Cascader options={classOptions} placeholder=\"请选择分类\" />)\r\n              }\r\n            </FormItem>\r\n\r\n            <FormItem label=\"描述\">\r\n              {\r\n                getFieldDecorator('description', {\r\n                  rules: [{ required: true, message: '请输入140字以内的描述！' }],\r\n                })(<Input.TextArea maxLength={140} placeholder='请输入140字以内的描述' />)\r\n              }\r\n            </FormItem>\r\n          </Form>\r\n\r\n        </Modal>\r\n      );\r\n    }\r\n  }\r\n);\r\n\r\nclass PublishPop extends React.Component {\r\n  handleCreate = () => {\r\n    const form = this.formRef.props.form;\r\n    const { currentArticleId, handlePublish } = this.props;\r\n    handlePublish(form, currentArticleId);\r\n  }\r\n\r\n  saveFormRef = (formRef) => {\r\n    this.formRef = formRef;\r\n  }\r\n\r\n  render() {\r\n    const { articlesData, currentArticleId, pubPanelShow, handleCancel, handleFieldsChange, modelOkText } = this.props;\r\n    const article = articlesData.find((article) => article.articleId === currentArticleId);\r\n    let title = article ? article.articleName : '';\r\n    return (\r\n      <CollectionCreateForm\r\n        wrappedComponentRef={this.saveFormRef}\r\n        visible={pubPanelShow}\r\n        onCancel={handleCancel}\r\n        onCreate={this.handleCreate}\r\n        onChange={handleFieldsChange}\r\n        title={title.slice(0, 40)}\r\n        modelOkText={modelOkText}\r\n      />\r\n    );\r\n  }\r\n}\r\n\r\nconst mapState = (state) => ({\r\n  pubPanelShow: state.getIn(['write', 'pubPanelShow']),\r\n  currentArticleId: state.getIn(['write', 'currentArticleId']),\r\n  modelOkText: state.getIn(['write', 'modelOkText']),\r\n});\r\nconst mapDispatch = (dispatch) => ({\r\n  handleCancel() {\r\n    dispatch(actionCreators.changeStatus('pubPanelShow', false));\r\n  },\r\n  handleFieldsChange(changedFields) {\r\n    console.log(changedFields);\r\n  },\r\n  handlePublish(form, articleId) {\r\n    form.validateFields((err, values) => {\r\n      if (err) {\r\n        return;\r\n      }\r\n      const obj = { ...values, articleId }\r\n      dispatch(actionCreators.publishAsyncAC(obj));\r\n      form.resetFields();\r\n    });\r\n  }\r\n});\r\n\r\nexport default connect(mapState, mapDispatch)(PublishPop);","\nvar content = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../../../node_modules/css-loader/index.js!../../../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"\", \"\"]);\n\n// exports\n","\nvar content = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\nif(typeof content === 'string') content = [[module.id, content, '']];\n\nvar transform;\nvar insertInto;\n\n\n\nvar options = {\"hmr\":true}\n\noptions.transform = transform\noptions.insertInto = undefined;\n\nvar update = require(\"!../../../node_modules/style-loader/lib/addStyles.js\")(content, options);\n\nif(content.locals) module.exports = content.locals;\n\nif(module.hot) {\n\tmodule.hot.accept(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/sass-loader/lib/loader.js!./index.scss\", function() {\n\t\tvar newContent = require(\"!!../../../node_modules/css-loader/index.js!../../../node_modules/sass-loader/lib/loader.js!./index.scss\");\n\n\t\tif(typeof newContent === 'string') newContent = [[module.id, newContent, '']];\n\n\t\tvar locals = (function(a, b) {\n\t\t\tvar key, idx = 0;\n\n\t\t\tfor(key in a) {\n\t\t\t\tif(!b || a[key] !== b[key]) return false;\n\t\t\t\tidx++;\n\t\t\t}\n\n\t\t\tfor(key in b) idx--;\n\n\t\t\treturn idx === 0;\n\t\t}(content.locals, newContent.locals));\n\n\t\tif(!locals) throw new Error('Aborting CSS HMR due to changed css-modules locals.');\n\n\t\tupdate(newContent);\n\t});\n\n\tmodule.hot.dispose(function() { update(); });\n}","exports = module.exports = require(\"../../../node_modules/css-loader/lib/css-base.js\")(false);\n// imports\n\n\n// module\nexports.push([module.id, \"@charset \\\"UTF-8\\\";\\n.main {\\n  position: absolute;\\n  top: 0;\\n  bottom: 0;\\n  left: 0;\\n  right: 0;\\n  z-index: 100; }\\n  .main .sider-fixed {\\n    position: fixed;\\n    left: 0;\\n    height: 100vh;\\n    overflow: auto; }\\n  .main .editor_container {\\n    position: relative; }\\n    .main .editor_container .show_mask {\\n      display: flex;\\n      width: 100%;\\n      height: 100%;\\n      background: #e3e3e3;\\n      position: absolute;\\n      z-index: 10002;\\n      justify-content: center;\\n      align-items: center;\\n      font-size: 30px; }\\n    .main .editor_container .hide_mask {\\n      display: none; }\\n    .main .editor_container .editor_title {\\n      width: 100%;\\n      padding: 20px 80px 10px 40px;\\n      margin-bottom: 0;\\n      border: none;\\n      font-size: 30px;\\n      font-weight: 400;\\n      line-height: 30px;\\n      text-align: center;\\n      -webkit-box-shadow: none;\\n      box-shadow: none;\\n      color: #595959;\\n      background-color: transparent;\\n      outline: none;\\n      border-radius: 0;\\n      overflow: hidden;\\n      -o-text-overflow: ellipsis;\\n      text-overflow: ellipsis;\\n      white-space: nowrap; }\\n    .main .editor_container .editor_border {\\n      border-bottom: 1px solid #ddd; }\\n    .main .editor_container .editor_toolbar {\\n      margin: 0 auto;\\n      width: 980px; }\\n    .main .editor_container .editor_text {\\n      height: calc(100vh - 102px);\\n      width: 1080px;\\n      margin: 0 auto; }\\n      .main .editor_container .editor_text > div:nth-of-type(1) {\\n        padding: 50px;\\n        overflow-y: auto;\\n        font-size: 16px;\\n        /* table 样式 */\\n        /* blockquote 样式 */\\n        /* code 样式 */\\n        /* ul ol 样式 */ }\\n        .main .editor_container .editor_text > div:nth-of-type(1) h1, .main .editor_container .editor_text > div:nth-of-type(1) h2, .main .editor_container .editor_text > div:nth-of-type(1) h3, .main .editor_container .editor_text > div:nth-of-type(1) h4, .main .editor_container .editor_text > div:nth-of-type(1) h5, .main .editor_container .editor_text > div:nth-of-type(1) h6 {\\n          text-rendering: optimizelegibility;\\n          line-height: 1.7;\\n          margin: 0 0 15px;\\n          font-weight: 700; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) h1 {\\n          font-size: 26px; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) h2 {\\n          font-size: 24px; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) h3 {\\n          font-size: 22px; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) h4 {\\n          font-size: 20px; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) h5 {\\n          font-size: 18px; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) table {\\n          border-top: 1px solid #ccc;\\n          border-left: 1px solid #ccc; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) table td,\\n        .main .editor_container .editor_text > div:nth-of-type(1) table th {\\n          border-bottom: 1px solid #ccc;\\n          border-right: 1px solid #ccc;\\n          padding: 3px 5px; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) table th {\\n          border-bottom: 2px solid #ccc;\\n          text-align: center; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) blockquote {\\n          display: block;\\n          border-left: 8px solid #acd6f3;\\n          padding: 5px 10px;\\n          margin: 10px 0;\\n          line-height: 1.4;\\n          font-size: 100%;\\n          background-color: #e1ebf2; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) code {\\n          display: inline-block;\\n          *display: inline;\\n          *zoom: 1;\\n          background-color: #eaead6;\\n          border-radius: 3px;\\n          padding: 3px 5px;\\n          margin: 0 3px; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) pre code {\\n          display: block; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) ul, .main .editor_container .editor_text > div:nth-of-type(1) ol {\\n          margin: 1em; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) ul {\\n          list-style: circle; }\\n        .main .editor_container .editor_text > div:nth-of-type(1) ol {\\n          list-style: decimal; }\\n\", \"\"]);\n\n// exports\n"],"sourceRoot":""}